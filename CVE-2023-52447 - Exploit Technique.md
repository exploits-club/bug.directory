tags: #kCTF #linux #race_condition #uaf #info_leak #lpe #hypervisor #kernel
original link:  [CVE-2023-52447 - Exploit Technique](https://github.com/google/security-research/blob/master/pocs/linux/kernelctf/CVE-2023-52447_cos/docs/exploit.md?ref=blog.exploits.club)
newsletter link: [exploits.club Weekly Newsletter 42 - Glitching With A Lighter, Pixel 9 Baseband Security, Node.js Pipe Madness, And More](https://blog.exploits.club/exploits-club-weekly-newsletter-42-glitching-with-a-lighter-pixel-9-baseband-security-node-js-pipe-madness-and-more/)

---
## Exploits Club Summary:
> Honestly, [this](https://x.com/pwningsystems/status/1844351855176057334?ref=blog.exploits.club) tweet feels very applicable recently. A **new write-up hosted in the kCTF repo walks through** [**CVE-2023-52447**](https://nvd.nist.gov/vuln/detail/CVE-2023-52447?ref=blog.exploits.club)**, a race condition leading to a UAF due to mismatched refcounts.** The crux of the bug stems from the fact that **bpf lock is running under `rcu_lock`, allowing for a lookup of arraymaps from array_of_maps (who names this shit) without increasing a refcount.** As such the researcher demonstrated how this **can be leveraged into a use-after-free,** causing a kernel leak. From there, the post goes into further exploitation, demonstrating how this primitive can be used to achieve an eventual container escape.